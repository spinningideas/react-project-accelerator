import{q as C,d as R,r as t,j as e,L as S,C as m,e as h,f as x,t as w,g as p,I as f,B as T,z as r,D as L,E as I,y as E}from"./index-CBnQef75.js";const q=()=>{const{token:i}=C(),n=R(),[o,g]=t.useState(""),[d,j]=t.useState(""),[l,c]=t.useState(!1),[v,u]=t.useState(!0),[P,k]=t.useState(!1),[y,N]=t.useState("");t.useEffect(()=>{(async()=>{if(!i){r({title:"Invalid Link",description:"No reset token provided."}),n("/signin");return}u(!0);const s=await L(i);s.success&&s.data?(k(!0),N(s.data.email)):(r({title:"Invalid Link",description:s.message||"This password reset link is invalid or has expired."}),setTimeout(()=>n("/forgot-password"),3e3)),u(!1)})()},[i,n]);const b=async a=>{if(a.preventDefault(),o!==d){r({title:"Passwords Don't Match",description:"Please make sure both passwords match."});return}if(o.length<8){r({title:"Password Too Short",description:"Password must be at least 8 characters long."});return}if(i){c(!0);try{const s=await I(i,o);s.success?(E({title:"Password Reset",description:"Your password has been reset successfully. You can now sign in."}),setTimeout(()=>n("/signin"),2e3)):r({title:"Reset Failed",description:s.message||"Failed to reset password."})}catch(s){r({title:"Reset Failed",description:s.message||"Failed to reset password."})}finally{c(!1)}}};return v?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(S,{loading:!0})}):P?e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 bg-white/80 dark:bg-black",children:e.jsxs(m,{className:"w-full max-w-md mx-auto",children:[e.jsxs(h,{children:[e.jsx(x,{children:"Reset Password"}),e.jsxs(w,{children:["Enter your new password for ",y]})]}),e.jsx(p,{children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"newPassword",className:"text-sm font-medium",children:"New Password"}),e.jsx(f,{id:"newPassword",type:"password",placeholder:"••••••••",value:o,onChange:a=>g(a.target.value),required:!0,minLength:8}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Must be at least 8 characters long"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"confirmPassword",className:"text-sm font-medium",children:"Confirm Password"}),e.jsx(f,{id:"confirmPassword",type:"password",placeholder:"••••••••",value:d,onChange:a=>j(a.target.value),required:!0,minLength:8})]}),e.jsx(T,{type:"submit",className:"w-full",disabled:l,children:l?"Resetting...":"Reset Password"})]})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 bg-white/80 dark:bg-black",children:e.jsxs(m,{className:"w-full max-w-md mx-auto",children:[e.jsxs(h,{children:[e.jsx(x,{children:"Invalid Link"}),e.jsx(w,{children:"This password reset link is invalid or has expired."})]}),e.jsx(p,{children:e.jsx("p",{className:"text-center text-gray-600 dark:text-gray-400",children:"Redirecting to password reset request page..."})})]})})};export{q as default};
