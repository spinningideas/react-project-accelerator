{"version":3,"file":"ResetPassword-CQwhUtRh.js","sources":["../../src/pages/auth/ResetPassword.tsx"],"sourcesContent":["import { useState, useEffect, type FormEvent } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"@/components/ui/card\";\r\nimport { toastError, toastSuccess } from \"@/hooks/use-toast\";\r\nimport { validateResetToken, resetPassword } from \"@/services/auth\";\r\nimport { LoadingIndicator } from \"@/components/shared/LoadingIndicator\";\r\n\r\nconst ResetPassword = () => {\r\n  const { token } = useParams<{ token: string }>();\r\n  const navigate = useNavigate();\r\n  \r\n  const [newPassword, setNewPassword] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isValidating, setIsValidating] = useState(true);\r\n  const [tokenValid, setTokenValid] = useState(false);\r\n  const [email, setEmail] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const validateToken = async () => {\r\n      if (!token) {\r\n        toastError({ title: \"Invalid Link\", description: \"No reset token provided.\" });\r\n        navigate(\"/signin\");\r\n        return;\r\n      }\r\n\r\n      setIsValidating(true);\r\n      const response = await validateResetToken(token);\r\n      \r\n      if (response.success && response.data) {\r\n        setTokenValid(true);\r\n        setEmail(response.data.email);\r\n      } else {\r\n        toastError({\r\n          title: \"Invalid Link\",\r\n          description: response.message || \"This password reset link is invalid or has expired.\",\r\n        });\r\n        setTimeout(() => navigate(\"/forgot-password\"), 3000);\r\n      }\r\n      setIsValidating(false);\r\n    };\r\n\r\n    validateToken();\r\n  }, [token, navigate]);\r\n\r\n  const handleSubmit = async (e: FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    if (newPassword !== confirmPassword) {\r\n      toastError({ title: \"Passwords Don't Match\", description: \"Please make sure both passwords match.\" });\r\n      return;\r\n    }\r\n\r\n    if (newPassword.length < 8) {\r\n      toastError({ title: \"Password Too Short\", description: \"Password must be at least 8 characters long.\" });\r\n      return;\r\n    }\r\n\r\n    if (!token) return;\r\n\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await resetPassword(token, newPassword);\r\n      if (response.success) {\r\n        toastSuccess({\r\n          title: \"Password Reset\",\r\n          description: \"Your password has been reset successfully. You can now sign in.\",\r\n        });\r\n        setTimeout(() => navigate(\"/signin\"), 2000);\r\n      } else {\r\n        toastError({\r\n          title: \"Reset Failed\",\r\n          description: response.message || \"Failed to reset password.\",\r\n        });\r\n      }\r\n    } catch (error: any) {\r\n      toastError({\r\n        title: \"Reset Failed\",\r\n        description: error.message || \"Failed to reset password.\",\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  if (isValidating) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <LoadingIndicator loading={true} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!tokenValid) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center px-4 bg-white/80 dark:bg-black\">\r\n        <Card className=\"w-full max-w-md mx-auto\">\r\n          <CardHeader>\r\n            <CardTitle>Invalid Link</CardTitle>\r\n            <CardDescription>\r\n              This password reset link is invalid or has expired.\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-center text-gray-600 dark:text-gray-400\">\r\n              Redirecting to password reset request page...\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center px-4 bg-white/80 dark:bg-black\">\r\n      <Card className=\"w-full max-w-md mx-auto\">\r\n        <CardHeader>\r\n          <CardTitle>Reset Password</CardTitle>\r\n          <CardDescription>\r\n            Enter your new password for {email}\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <label htmlFor=\"newPassword\" className=\"text-sm font-medium\">\r\n                New Password\r\n              </label>\r\n              <Input\r\n                id=\"newPassword\"\r\n                type=\"password\"\r\n                placeholder=\"••••••••\"\r\n                value={newPassword}\r\n                onChange={(e) => setNewPassword(e.target.value)}\r\n                required\r\n                minLength={8}\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Must be at least 8 characters long\r\n              </p>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <label htmlFor=\"confirmPassword\" className=\"text-sm font-medium\">\r\n                Confirm Password\r\n              </label>\r\n              <Input\r\n                id=\"confirmPassword\"\r\n                type=\"password\"\r\n                placeholder=\"••••••••\"\r\n                value={confirmPassword}\r\n                onChange={(e) => setConfirmPassword(e.target.value)}\r\n                required\r\n                minLength={8}\r\n              />\r\n            </div>\r\n            <Button\r\n              type=\"submit\"\r\n              className=\"w-full\"\r\n              disabled={isLoading}\r\n            >\r\n              {isLoading ? \"Resetting...\" : \"Reset Password\"}\r\n            </Button>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResetPassword;\r\n"],"names":["ResetPassword","token","useParams","navigate","useNavigate","newPassword","setNewPassword","useState","confirmPassword","setConfirmPassword","isLoading","setIsLoading","isValidating","setIsValidating","tokenValid","setTokenValid","email","setEmail","useEffect","toastError","response","validateResetToken","handleSubmit","e","resetPassword","toastSuccess","error","jsx","LoadingIndicator","jsxs","Card","CardHeader","CardTitle","CardDescription","CardContent","Input","Button"],"mappings":"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"}